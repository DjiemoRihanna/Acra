{% extends "layouts/auth_base.html" %}

{% block title %}Vérification MFA | ACRA SOC{% endblock %}

{% block content %}
<div class="auth-container">
    <div class="auth-card">
        <div style="margin-bottom: 25px; text-align: center;">
            <i class="fas fa-key" style="font-size: 2.5rem; color: var(--acra-cyan); margin-bottom: 15px;"></i>
            <h2 style="letter-spacing: 2px; text-transform: uppercase;">Double Authentification</h2>
            <p style="color: var(--text-muted); font-size: 0.9rem;">Un code de sécurité temporaire est requis pour sécuriser votre session.</p>
        </div>

        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            {% for category, message in messages %}
              <div class="alert alert-{{ category }}" style="margin-bottom: 1.5rem; padding: 12px; border-radius: 6px; font-size: 0.85rem; text-align: center; border: 1px solid rgba(255,0,0,0.2);">
                  {{ message }}
              </div>
            {% endfor %}
          {% endif %}
        {% endwith %}

        <form method="POST" action="{{ url_for('auth.verify_mfa') }}" class="acra-form">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>

            <div class="form-group" style="margin-bottom: 25px;">
                <input type="text" name="code" placeholder="000000" maxlength="6"
                       style="width: 100%; padding: 15px; border: 1px solid var(--border-color); 
                              border-radius: 8px; background: var(--input-bg); color: var(--text-main); 
                              text-align: center; font-size: 2.2rem; letter-spacing: 10px; font-weight: bold;
                              box-shadow: inset 0 2px 4px rgba(0,0,0,0.3);" 
                       required autofocus autocomplete="off">
            </div>

            <button type="submit" class="btn-submit" style="width: 100%; padding: 14px; font-weight: bold; letter-spacing: 1px;">
                VALIDER L'ACCÈS
            </button>
        </form>

        <div style="margin-top: 25px; font-size: 0.8rem; color: var(--text-muted); text-align: center; border-top: 1px solid var(--border-color); padding-top: 15px;">
            <i class="fas fa-terminal" style="margin-right: 5px;"></i> 
            Mode Debug : Le code est visible dans la console serveur.
        </div>
    </div>
</div>
{% endblock %}